asyncapi: 3.0.0
info:
  title: Bookly Availability Service Events
  version: 1.0.0
  description: |
    Event-driven architecture documentation for Bookly's availability and reservation management system.
    This service handles reservation scheduling, availability management, and calendar integration.
  contact:
    name: Bookly Development Team
    email: dev@booklyapp.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

defaultContentType: application/json

servers:
  development:
    host: localhost:5672
    protocol: amqp
    description: Local RabbitMQ development server
  production:
    host: rabbitmq.booklyapp.com:5672
    protocol: amqp
    description: Production RabbitMQ server

channels:
  reservation-management:
    description: Channel for reservation management events
    messages:
      reservationCreated:
        $ref: "#/components/messages/ReservationCreated"
      reservationUpdated:
        $ref: "#/components/messages/ReservationUpdated"
      reservationCancelled:
        $ref: "#/components/messages/ReservationCancelled"
      reservationConfirmed:
        $ref: "#/components/messages/ReservationConfirmed"
      reservationCheckIn:
        $ref: "#/components/messages/ReservationCheckIn"
      reservationCheckOut:
        $ref: "#/components/messages/ReservationCheckOut"

  availability-management:
    description: Channel for availability management events
    messages:
      availabilityUpdated:
        $ref: "#/components/messages/AvailabilityUpdated"
      availabilityBlocked:
        $ref: "#/components/messages/AvailabilityBlocked"
      availabilityUnblocked:
        $ref: "#/components/messages/AvailabilityUnblocked"
      recurringAvailabilityCreated:
        $ref: "#/components/messages/RecurringAvailabilityCreated"

  conflict-management:
    description: Channel for conflict and validation events
    messages:
      reservationConflictDetected:
        $ref: "#/components/messages/ReservationConflictDetected"
      reservationConflictResolved:
        $ref: "#/components/messages/ReservationConflictResolved"
      waitlistPositionChanged:
        $ref: "#/components/messages/WaitlistPositionChanged"

  recurring-reservation-management:
    description: Channel for recurring reservation lifecycle events (RF-12)
    messages:
      recurringReservationCreated:
        $ref: "#/components/messages/RecurringReservationCreated"
      recurringReservationUpdated:
        $ref: "#/components/messages/RecurringReservationUpdated"
      recurringReservationCancelled:
        $ref: "#/components/messages/RecurringReservationCancelled"
      recurringReservationInstancesGenerated:
        $ref: "#/components/messages/RecurringReservationInstancesGenerated"
      recurringReservationInstanceConfirmed:
        $ref: "#/components/messages/RecurringReservationInstanceConfirmed"
      recurringReservationInstanceCancelled:
        $ref: "#/components/messages/RecurringReservationInstanceCancelled"
      recurringReservationConflictDetected:
        $ref: "#/components/messages/RecurringReservationConflictDetected"
      recurringReservationCompleted:
        $ref: "#/components/messages/RecurringReservationCompleted"
      recurringReservationValidationFailed:
        $ref: "#/components/messages/RecurringReservationValidationFailed"

  waiting-list-management:
    description: Channel for waiting list lifecycle events (RF-14)
    messages:
      userJoinedWaitingList:
        $ref: "#/components/messages/UserJoinedWaitingList"
      userLeftWaitingList:
        $ref: "#/components/messages/UserLeftWaitingList"
      waitingListSlotAvailable:
        $ref: "#/components/messages/WaitingListSlotAvailable"
      userConfirmedWaitingListSlot:
        $ref: "#/components/messages/UserConfirmedWaitingListSlot"
      waitingListSlotExpired:
        $ref: "#/components/messages/WaitingListSlotExpired"
      waitingListPositionsReordered:
        $ref: "#/components/messages/WaitingListPositionsReordered"
      waitingListPriorityEscalated:
        $ref: "#/components/messages/WaitingListPriorityEscalated"
      waitingListOptimized:
        $ref: "#/components/messages/WaitingListOptimized"
      waitingListBulkNotificationSent:
        $ref: "#/components/messages/WaitingListBulkNotificationSent"
      waitingListPreferencesUpdated:
        $ref: "#/components/messages/WaitingListPreferencesUpdated"

  reassignment-management:
    description: Channel for reservation reassignment events (RF-15)
    messages:
      reassignmentRequestCreated:
        $ref: "#/components/messages/ReassignmentRequestCreated"
      reassignmentRequestResponded:
        $ref: "#/components/messages/ReassignmentRequestResponded"
      equivalentResourcesFound:
        $ref: "#/components/messages/EquivalentResourcesFound"
      reassignmentRequestProcessed:
        $ref: "#/components/messages/ReassignmentRequestProcessed"
      reassignmentApplied:
        $ref: "#/components/messages/ReassignmentApplied"
      reassignmentRequestCancelled:
        $ref: "#/components/messages/ReassignmentRequestCancelled"
      reassignmentRequestEscalated:
        $ref: "#/components/messages/ReassignmentRequestEscalated"
      reassignmentSuggestionRejected:
        $ref: "#/components/messages/ReassignmentSuggestionRejected"
      reassignmentQueueOptimized:
        $ref: "#/components/messages/ReassignmentQueueOptimized"
      bulkReassignmentRequestsProcessed:
        $ref: "#/components/messages/BulkReassignmentRequestsProcessed"
      reassignmentRequestExpired:
        $ref: "#/components/messages/ReassignmentRequestExpired"

operations:
  publishReservationCreated:
    action: send
    channel:
      $ref: "#/channels/reservation-management"
    messages:
      - $ref: "#/channels/reservation-management/messages/reservationCreated"
    description: Published when a new reservation is created

  publishReservationUpdated:
    action: send
    channel:
      $ref: "#/channels/reservation-management"
    messages:
      - $ref: "#/channels/reservation-management/messages/reservationUpdated"
    description: Published when a reservation is updated

  publishReservationCancelled:
    action: send
    channel:
      $ref: "#/channels/reservation-management"
    messages:
      - $ref: "#/channels/reservation-management/messages/reservationCancelled"
    description: Published when a reservation is cancelled

  publishAvailabilityUpdated:
    action: send
    channel:
      $ref: "#/channels/availability-management"
    messages:
      - $ref: "#/channels/availability-management/messages/availabilityUpdated"
    description: Published when resource availability is updated

  publishReservationConflictDetected:
    action: send
    channel:
      $ref: "#/channels/conflict-management"
    messages:
      - $ref: "#/channels/conflict-management/messages/reservationConflictDetected"
    description: Published when a reservation conflict is detected

components:
  messages:
    ReservationCreated:
      name: ReservationCreated
      title: Reservation Created Event
      summary: Event published when a new reservation is created
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationCreatedPayload"

    ReservationUpdated:
      name: ReservationUpdated
      title: Reservation Updated Event
      summary: Event published when a reservation is updated
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationUpdatedPayload"

    ReservationCancelled:
      name: ReservationCancelled
      title: Reservation Cancelled Event
      summary: Event published when a reservation is cancelled
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationCancelledPayload"

    ReservationConfirmed:
      name: ReservationConfirmed
      title: Reservation Confirmed Event
      summary: Event published when a reservation is confirmed
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationConfirmedPayload"

    ReservationCheckIn:
      name: ReservationCheckIn
      title: Reservation Check-In Event
      summary: Event published when a user checks in to their reservation
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationCheckInPayload"

    ReservationCheckOut:
      name: ReservationCheckOut
      title: Reservation Check-Out Event
      summary: Event published when a user checks out from their reservation
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationCheckOutPayload"

    AvailabilityUpdated:
      name: AvailabilityUpdated
      title: Availability Updated Event
      summary: Event published when resource availability is updated
      contentType: application/json
      payload:
        $ref: "#/components/schemas/AvailabilityUpdatedPayload"

    AvailabilityBlocked:
      name: AvailabilityBlocked
      title: Availability Blocked Event
      summary: Event published when resource availability is blocked
      contentType: application/json
      payload:
        $ref: "#/components/schemas/AvailabilityBlockedPayload"

    AvailabilityUnblocked:
      name: AvailabilityUnblocked
      title: Availability Unblocked Event
      summary: Event published when resource availability is unblocked
      contentType: application/json
      payload:
        $ref: "#/components/schemas/AvailabilityUnblockedPayload"

    RecurringAvailabilityCreated:
      name: RecurringAvailabilityCreated
      title: Recurring Availability Created Event
      summary: Event published when recurring availability is created
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringAvailabilityCreatedPayload"

    ReservationConflictDetected:
      name: ReservationConflictDetected
      title: Reservation Conflict Detected Event
      summary: Event published when a reservation conflict is detected
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationConflictDetectedPayload"

    ReservationConflictResolved:
      name: ReservationConflictResolved
      title: Reservation Conflict Resolved Event
      summary: Event published when a reservation conflict is resolved
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReservationConflictResolvedPayload"

    WaitlistPositionChanged:
      name: WaitlistPositionChanged
      title: Waitlist Position Changed Event
      summary: Event published when a user's waitlist position changes
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitlistPositionChangedPayload"

    # Recurring Reservation Events (RF-12)
    RecurringReservationCreated:
      name: RecurringReservationCreated
      title: Recurring Reservation Created Event
      summary: Event published when a recurring reservation is created
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationCreatedPayload"

    RecurringReservationUpdated:
      name: RecurringReservationUpdated
      title: Recurring Reservation Updated Event
      summary: Event published when a recurring reservation is updated
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationUpdatedPayload"

    RecurringReservationCancelled:
      name: RecurringReservationCancelled
      title: Recurring Reservation Cancelled Event
      summary: Event published when a recurring reservation is cancelled
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationCancelledPayload"

    RecurringReservationInstancesGenerated:
      name: RecurringReservationInstancesGenerated
      title: Recurring Reservation Instances Generated Event
      summary: Event published when instances are generated for a recurring reservation
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationInstancesGeneratedPayload"

    RecurringReservationInstanceConfirmed:
      name: RecurringReservationInstanceConfirmed
      title: Recurring Reservation Instance Confirmed Event
      summary: Event published when a recurring reservation instance is confirmed
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationInstanceConfirmedPayload"

    RecurringReservationInstanceCancelled:
      name: RecurringReservationInstanceCancelled
      title: Recurring Reservation Instance Cancelled Event
      summary: Event published when a recurring reservation instance is cancelled
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationInstanceCancelledPayload"

    RecurringReservationConflictDetected:
      name: RecurringReservationConflictDetected
      title: Recurring Reservation Conflict Detected Event
      summary: Event published when a conflict is detected in recurring reservations
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationConflictDetectedPayload"

    RecurringReservationCompleted:
      name: RecurringReservationCompleted
      title: Recurring Reservation Completed Event
      summary: Event published when a recurring reservation series is completed
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationCompletedPayload"

    RecurringReservationValidationFailed:
      name: RecurringReservationValidationFailed
      title: Recurring Reservation Validation Failed Event
      summary: Event published when recurring reservation validation fails
      contentType: application/json
      payload:
        $ref: "#/components/schemas/RecurringReservationValidationFailedPayload"

    # Waiting List Events (RF-14)
    UserJoinedWaitingList:
      name: UserJoinedWaitingList
      title: User Joined Waiting List Event
      summary: Event published when a user joins a waiting list
      contentType: application/json
      payload:
        $ref: "#/components/schemas/UserJoinedWaitingListPayload"

    UserLeftWaitingList:
      name: UserLeftWaitingList
      title: User Left Waiting List Event
      summary: Event published when a user leaves a waiting list
      contentType: application/json
      payload:
        $ref: "#/components/schemas/UserLeftWaitingListPayload"

    WaitingListSlotAvailable:
      name: WaitingListSlotAvailable
      title: Waiting List Slot Available Event
      summary: Event published when a slot becomes available for waiting list users
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitingListSlotAvailablePayload"

    UserConfirmedWaitingListSlot:
      name: UserConfirmedWaitingListSlot
      title: User Confirmed Waiting List Slot Event
      summary: Event published when a user confirms their waiting list slot
      contentType: application/json
      payload:
        $ref: "#/components/schemas/UserConfirmedWaitingListSlotPayload"

    WaitingListSlotExpired:
      name: WaitingListSlotExpired
      title: Waiting List Slot Expired Event
      summary: Event published when a waiting list slot expires
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitingListSlotExpiredPayload"

    WaitingListPositionsReordered:
      name: WaitingListPositionsReordered
      title: Waiting List Positions Reordered Event
      summary: Event published when waiting list positions are reordered
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitingListPositionsReorderedPayload"

    WaitingListPriorityEscalated:
      name: WaitingListPriorityEscalated
      title: Waiting List Priority Escalated Event
      summary: Event published when a waiting list entry priority is escalated
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitingListPriorityEscalatedPayload"

    WaitingListOptimized:
      name: WaitingListOptimized
      title: Waiting List Optimized Event
      summary: Event published when waiting list is optimized
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitingListOptimizedPayload"

    WaitingListBulkNotificationSent:
      name: WaitingListBulkNotificationSent
      title: Waiting List Bulk Notification Sent Event
      summary: Event published when bulk notifications are sent to waiting list users
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitingListBulkNotificationSentPayload"

    WaitingListPreferencesUpdated:
      name: WaitingListPreferencesUpdated
      title: Waiting List Preferences Updated Event
      summary: Event published when waiting list preferences are updated
      contentType: application/json
      payload:
        $ref: "#/components/schemas/WaitingListPreferencesUpdatedPayload"

    # Reassignment Events (RF-15)
    ReassignmentRequestCreated:
      name: ReassignmentRequestCreated
      title: Reassignment Request Created Event
      summary: Event published when a reassignment request is created
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentRequestCreatedPayload"

    ReassignmentRequestResponded:
      name: ReassignmentRequestResponded
      title: Reassignment Request Responded Event
      summary: Event published when a user responds to a reassignment request
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentRequestRespondedPayload"

    EquivalentResourcesFound:
      name: EquivalentResourcesFound
      title: Equivalent Resources Found Event
      summary: Event published when equivalent resources are found for reassignment
      contentType: application/json
      payload:
        $ref: "#/components/schemas/EquivalentResourcesFoundPayload"

    ReassignmentRequestProcessed:
      name: ReassignmentRequestProcessed
      title: Reassignment Request Processed Event
      summary: Event published when a reassignment request is processed
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentRequestProcessedPayload"

    ReassignmentApplied:
      name: ReassignmentApplied
      title: Reassignment Applied Event
      summary: Event published when a reassignment is successfully applied
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentAppliedPayload"

    ReassignmentRequestCancelled:
      name: ReassignmentRequestCancelled
      title: Reassignment Request Cancelled Event
      summary: Event published when a reassignment request is cancelled
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentRequestCancelledPayload"

    ReassignmentRequestEscalated:
      name: ReassignmentRequestEscalated
      title: Reassignment Request Escalated Event
      summary: Event published when a reassignment request is escalated
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentRequestEscalatedPayload"

    ReassignmentSuggestionRejected:
      name: ReassignmentSuggestionRejected
      title: Reassignment Suggestion Rejected Event
      summary: Event published when a reassignment suggestion is rejected
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentSuggestionRejectedPayload"

    ReassignmentQueueOptimized:
      name: ReassignmentQueueOptimized
      title: Reassignment Queue Optimized Event
      summary: Event published when the reassignment queue is optimized
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentQueueOptimizedPayload"

    BulkReassignmentRequestsProcessed:
      name: BulkReassignmentRequestsProcessed
      title: Bulk Reassignment Requests Processed Event
      summary: Event published when bulk reassignment requests are processed
      contentType: application/json
      payload:
        $ref: "#/components/schemas/BulkReassignmentRequestsProcessedPayload"

    ReassignmentRequestExpired:
      name: ReassignmentRequestExpired
      title: Reassignment Request Expired Event
      summary: Event published when a reassignment request expires
      contentType: application/json
      payload:
        $ref: "#/components/schemas/ReassignmentRequestExpiredPayload"

  schemas:
    DomainEvent:
      type: object
      required:
        - eventId
        - eventType
        - aggregateId
        - aggregateType
        - eventData
        - timestamp
        - version
      properties:
        eventId:
          type: string
          format: uuid
          description: Unique identifier for the event
        eventType:
          type: string
          description: Type of the event
        aggregateId:
          type: string
          description: ID of the aggregate that generated the event
        aggregateType:
          type: string
          description: Type of the aggregate
        eventData:
          type: object
          description: Event-specific data payload
        timestamp:
          type: string
          format: date-time
          description: When the event occurred
        version:
          type: integer
          description: Version of the event schema

    ReservationCreatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reservationId
                - resourceId
                - userId
                - startTime
                - endTime
                - status
              properties:
                reservationId:
                  type: string
                  description: ID of the created reservation
                resourceId:
                  type: string
                  description: ID of the reserved resource
                userId:
                  type: string
                  description: ID of the user who made the reservation
                startTime:
                  type: string
                  format: date-time
                  description: Start time of the reservation
                endTime:
                  type: string
                  format: date-time
                  description: End time of the reservation
                status:
                  type: string
                  description: Status of the reservation
                purpose:
                  type: string
                  description: Purpose of the reservation
                attendees:
                  type: integer
                  description: Expected number of attendees

    ReservationUpdatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reservationId
                - updatedBy
                - changes
              properties:
                reservationId:
                  type: string
                  description: ID of the updated reservation
                updatedBy:
                  type: string
                  description: ID of the user who updated the reservation
                changes:
                  type: object
                  description: Fields that were changed
                previousValues:
                  type: object
                  description: Previous values of changed fields

    ReservationCancelledPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reservationId
                - cancelledBy
                - reason
                - cancelledAt
              properties:
                reservationId:
                  type: string
                  description: ID of the cancelled reservation
                cancelledBy:
                  type: string
                  description: ID of the user who cancelled the reservation
                reason:
                  type: string
                  description: Reason for cancellation
                cancelledAt:
                  type: string
                  format: date-time
                  description: When the reservation was cancelled
                refundAmount:
                  type: number
                  description: Amount refunded if applicable

    ReservationConfirmedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reservationId
                - confirmedBy
                - confirmedAt
              properties:
                reservationId:
                  type: string
                  description: ID of the confirmed reservation
                confirmedBy:
                  type: string
                  description: ID of the user who confirmed the reservation
                confirmedAt:
                  type: string
                  format: date-time
                  description: When the reservation was confirmed

    ReservationCheckInPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reservationId
                - userId
                - checkInTime
              properties:
                reservationId:
                  type: string
                  description: ID of the reservation
                userId:
                  type: string
                  description: ID of the user checking in
                checkInTime:
                  type: string
                  format: date-time
                  description: When the check-in occurred
                location:
                  type: object
                  description: Location data if available

    ReservationCheckOutPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reservationId
                - userId
                - checkOutTime
              properties:
                reservationId:
                  type: string
                  description: ID of the reservation
                userId:
                  type: string
                  description: ID of the user checking out
                checkOutTime:
                  type: string
                  format: date-time
                  description: When the check-out occurred
                actualDuration:
                  type: integer
                  description: Actual duration in minutes

    AvailabilityUpdatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - resourceId
                - updatedBy
                - availabilityRules
              properties:
                resourceId:
                  type: string
                  description: ID of the resource
                updatedBy:
                  type: string
                  description: ID of the user who updated availability
                availabilityRules:
                  type: object
                  description: New availability rules
                effectiveDate:
                  type: string
                  format: date-time
                  description: When the new availability takes effect

    AvailabilityBlockedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - resourceId
                - blockedBy
                - startTime
                - endTime
                - reason
              properties:
                resourceId:
                  type: string
                  description: ID of the blocked resource
                blockedBy:
                  type: string
                  description: ID of the user who blocked the resource
                startTime:
                  type: string
                  format: date-time
                  description: Start time of the block
                endTime:
                  type: string
                  format: date-time
                  description: End time of the block
                reason:
                  type: string
                  description: Reason for blocking
                isRecurring:
                  type: boolean
                  description: Whether this is a recurring block

    AvailabilityUnblockedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - resourceId
                - unblockedBy
                - blockId
              properties:
                resourceId:
                  type: string
                  description: ID of the unblocked resource
                unblockedBy:
                  type: string
                  description: ID of the user who unblocked the resource
                blockId:
                  type: string
                  description: ID of the block that was removed

    RecurringAvailabilityCreatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - resourceId
                - createdBy
                - pattern
                - startDate
                - endDate
              properties:
                resourceId:
                  type: string
                  description: ID of the resource
                createdBy:
                  type: string
                  description: ID of the user who created the recurring availability
                pattern:
                  type: object
                  description: Recurrence pattern (daily, weekly, monthly, etc.)
                startDate:
                  type: string
                  format: date
                  description: Start date of the recurring pattern
                endDate:
                  type: string
                  format: date
                  description: End date of the recurring pattern

    ReservationConflictDetectedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - conflictId
                - reservationId
                - conflictingReservationId
                - resourceId
                - conflictType
              properties:
                conflictId:
                  type: string
                  description: ID of the conflict
                reservationId:
                  type: string
                  description: ID of the new reservation
                conflictingReservationId:
                  type: string
                  description: ID of the existing conflicting reservation
                resourceId:
                  type: string
                  description: ID of the resource in conflict
                conflictType:
                  type: string
                  description: Type of conflict (TIME_OVERLAP, RESOURCE_UNAVAILABLE, etc.)
                severity:
                  type: string
                  description: Severity of the conflict

    ReservationConflictResolvedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - conflictId
                - resolvedBy
                - resolution
              properties:
                conflictId:
                  type: string
                  description: ID of the resolved conflict
                resolvedBy:
                  type: string
                  description: ID of the user who resolved the conflict
                resolution:
                  type: string
                  description: How the conflict was resolved
                affectedReservations:
                  type: array
                  items:
                    type: string
                  description: IDs of reservations affected by the resolution

    WaitlistPositionChangedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - waitlistEntryId
                - userId
                - resourceId
                - previousPosition
                - newPosition
              properties:
                waitlistEntryId:
                  type: string
                  description: ID of the waitlist entry
                userId:
                  type: string
                  description: ID of the user on the waitlist
                resourceId:
                  type: string
                  description: ID of the resource
                previousPosition:
                  type: integer
                  description: Previous position in the waitlist
                newPosition:
                  type: integer
                  description: New position in the waitlist
                estimatedWaitTime:
                  type: integer
                  description: Estimated wait time in minutes

    # Recurring Reservation Event Payloads
    RecurringReservationCreatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - recurringReservationId
                - userId
                - resourceId
                - pattern
                - startDate
                - endDate
              properties:
                recurringReservationId:
                  type: string
                  description: ID of the recurring reservation
                userId:
                  type: string
                  description: ID of the user who created the recurring reservation
                resourceId:
                  type: string
                  description: ID of the resource
                pattern:
                  type: object
                  description: Recurrence pattern details
                startDate:
                  type: string
                  format: date
                endDate:
                  type: string
                  format: date
                totalInstances:
                  type: integer
                  description: Total number of instances to be created

    RecurringReservationUpdatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - recurringReservationId
                - updatedBy
                - changes
              properties:
                recurringReservationId:
                  type: string
                updatedBy:
                  type: string
                changes:
                  type: object
                  description: Fields that were changed
                affectedInstances:
                  type: array
                  items:
                    type: string
                  description: IDs of affected reservation instances

    RecurringReservationCancelledPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - recurringReservationId
                - cancelledBy
                - reason
              properties:
                recurringReservationId:
                  type: string
                cancelledBy:
                  type: string
                reason:
                  type: string
                cancelledInstances:
                  type: array
                  items:
                    type: string
                  description: IDs of cancelled instances

    RecurringReservationInstanceGeneratedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - recurringReservationId
                - instanceId
                - scheduledDate
              properties:
                recurringReservationId:
                  type: string
                instanceId:
                  type: string
                  description: ID of the generated reservation instance
                scheduledDate:
                  type: string
                  format: date-time
                instanceNumber:
                  type: integer
                  description: Sequential number of this instance

    RecurringReservationConflictDetectedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - recurringReservationId
                - conflictingInstanceId
                - conflictType
              properties:
                recurringReservationId:
                  type: string
                conflictingInstanceId:
                  type: string
                conflictType:
                  type: string
                conflictDetails:
                  type: object
                  description: Details about the conflict

    # Waiting List Event Payloads
    WaitingListUserJoinedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - waitingListEntryId
                - userId
                - resourceId
                - position
              properties:
                waitingListEntryId:
                  type: string
                userId:
                  type: string
                resourceId:
                  type: string
                position:
                  type: integer
                  description: Position in the waiting list
                priority:
                  type: string
                  description: Priority level
                estimatedWaitTime:
                  type: integer
                  description: Estimated wait time in minutes

    WaitingListUserLeftPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - waitingListEntryId
                - userId
                - resourceId
                - reason
              properties:
                waitingListEntryId:
                  type: string
                userId:
                  type: string
                resourceId:
                  type: string
                reason:
                  type: string
                  description: Reason for leaving (USER_LEFT, EXPIRED, CANCELLED)
                previousPosition:
                  type: integer

    WaitingListSlotAvailablePayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - resourceId
                - availableSlots
                - timeSlot
              properties:
                resourceId:
                  type: string
                availableSlots:
                  type: integer
                  description: Number of available slots
                timeSlot:
                  type: object
                  properties:
                    date:
                      type: string
                      format: date
                    startTime:
                      type: string
                    endTime:
                      type: string
                notifiedUsers:
                  type: array
                  items:
                    type: string
                  description: IDs of users notified about availability

    WaitingListPriorityEscalatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - waitingListEntryId
                - userId
                - previousPriority
                - newPriority
                - escalatedBy
              properties:
                waitingListEntryId:
                  type: string
                userId:
                  type: string
                previousPriority:
                  type: string
                newPriority:
                  type: string
                escalatedBy:
                  type: string
                  description: ID of the user who escalated the priority
                reason:
                  type: string
                  description: Reason for escalation

    # Reassignment Event Payloads
    ReassignmentRequestCreatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reassignmentRequestId
                - reservationId
                - requestedBy
                - reason
                - priority
              properties:
                reassignmentRequestId:
                  type: string
                reservationId:
                  type: string
                requestedBy:
                  type: string
                reason:
                  type: string
                priority:
                  type: string
                  enum: [LOW, MEDIUM, HIGH]
                suggestedResourceId:
                  type: string
                  description: Suggested alternative resource
                preferredTimeSlot:
                  type: object
                  description: Preferred alternative time slot

    ReassignmentRequestRespondedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reassignmentRequestId
                - userId
                - response
                - respondedAt
              properties:
                reassignmentRequestId:
                  type: string
                userId:
                  type: string
                response:
                  type: string
                  enum: [ACCEPT, REJECT]
                respondedAt:
                  type: string
                  format: date-time
                selectedResourceId:
                  type: string
                  description: Selected resource if accepted
                reason:
                  type: string
                  description: Reason for rejection if applicable

    ReassignmentAppliedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reassignmentRequestId
                - originalReservationId
                - newReservationId
                - appliedBy
              properties:
                reassignmentRequestId:
                  type: string
                originalReservationId:
                  type: string
                newReservationId:
                  type: string
                appliedBy:
                  type: string
                  description: ID of the user who applied the reassignment
                originalResourceId:
                  type: string
                newResourceId:
                  type: string
                appliedAt:
                  type: string
                  format: date-time

    ReassignmentCancelledPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reassignmentRequestId
                - cancelledBy
                - reason
              properties:
                reassignmentRequestId:
                  type: string
                cancelledBy:
                  type: string
                reason:
                  type: string
                cancelledAt:
                  type: string
                  format: date-time

    ReassignmentEscalatedPayload:
      allOf:
        - $ref: "#/components/schemas/DomainEvent"
        - type: object
          properties:
            eventData:
              type: object
              required:
                - reassignmentRequestId
                - escalatedBy
                - escalationLevel
                - reason
              properties:
                reassignmentRequestId:
                  type: string
                escalatedBy:
                  type: string
                escalationLevel:
                  type: string
                  enum: [SUPERVISOR, MANAGER, ADMIN]
                reason:
                  type: string
                escalatedAt:
                  type: string
                  format: date-time
